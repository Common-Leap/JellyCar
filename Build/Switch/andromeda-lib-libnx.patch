diff --git a/Andromeda/Audio/AudioManager.cpp b/Andromeda/Audio/AudioManager.cpp
index c15f65b..42df361 100644
--- a/Andromeda/Audio/AudioManager.cpp
+++ b/Andromeda/Audio/AudioManager.cpp
@@ -56,5 +56,14 @@ namespace Andromeda
 
 			return _audioManager;
 		}
+
+		void AudioManager::Shutdown()
+		{
+			if (_audioManager != 0)
+			{
+				delete _audioManager;
+				_audioManager = 0;
+			}
+		}
 	}
-}
\ No newline at end of file
+}
diff --git a/Andromeda/Audio/AudioManager.h b/Andromeda/Audio/AudioManager.h
index 1c5ffcd..c32ee69 100644
--- a/Andromeda/Audio/AudioManager.h
+++ b/Andromeda/Audio/AudioManager.h
@@ -20,6 +20,7 @@ namespace Andromeda
             AudioManager();
 
 			static AudioManager* Instance();
+			static void Shutdown();
 
 		public:
 
@@ -29,4 +30,4 @@ namespace Andromeda
 	}
 }
 
-#endif
\ No newline at end of file
+#endif
diff --git a/Andromeda/FileSystem/Stdio/StdioDirectory.cpp b/Andromeda/FileSystem/Stdio/StdioDirectory.cpp
index aa796e6..644f1af 100644
--- a/Andromeda/FileSystem/Stdio/StdioDirectory.cpp
+++ b/Andromeda/FileSystem/Stdio/StdioDirectory.cpp
@@ -27,6 +27,7 @@ namespace Andromeda
 			{
 				closedir(_directory);
 			}
+			_directory = nullptr;
 		}
 
 		std::vector<std::string> StdioDirectory::GetFiles()
@@ -56,7 +57,7 @@ namespace Andromeda
 		{
 			std::vector<std::string> allFiles = GetFiles();
 			std::vector<std::string> files;
-			
+
 			for (size_t i = 0; i < allFiles.size(); i++)
 			{
 				if (allFiles[i].find(extension) != std::string::npos)
@@ -69,4 +70,4 @@ namespace Andromeda
 		}
 
 	}
-}
\ No newline at end of file
+}
diff --git a/Andromeda/FileSystem/Stdio/StdioFile.cpp b/Andromeda/FileSystem/Stdio/StdioFile.cpp
index 75b9375..ff79c26 100644
--- a/Andromeda/FileSystem/Stdio/StdioFile.cpp
+++ b/Andromeda/FileSystem/Stdio/StdioFile.cpp
@@ -21,6 +21,8 @@ namespace Andromeda
 
 		bool StdioFile::Open(FileMode fileMode, FileType fileType)
 		{
+			Close();
+
 			if(fileMode == FileSystem::Read)
 			{
 				if(fileType == FileSystem::Binary)
@@ -29,7 +31,7 @@ namespace Andromeda
 				}else
 				{
 					_filBuf = fopen(_loadFileName.c_str(), "r");
-				}				
+				}
 			}
 			else if (fileMode == FileSystem::Write)
 			{
@@ -40,7 +42,7 @@ namespace Andromeda
 				else
 				{
 					_filBuf = fopen(_loadFileName.c_str(), "w");
-				}				
+				}
 			}
 			else
 			{
@@ -65,7 +67,10 @@ namespace Andromeda
 		void StdioFile::Close()
 		{
 			if (_filBuf != 0)
+			{
 				fclose(_filBuf);
+				_filBuf = 0;
+			}
 		}
 
 		bool StdioFile::Exist()
@@ -78,22 +83,35 @@ namespace Andromeda
 
 		void StdioFile::Read(void *data, unsigned int size, int count)
 		{
-			fread(data, size, count, _filBuf);
+			if (_filBuf != 0)
+			{
+				fread(data, size, count, _filBuf);
+			}
 		}
 
 		void StdioFile::Write(void *data, unsigned int size, int count)
 		{
-			fwrite(data, size, count, _filBuf);
+			if (_filBuf != 0)
+			{
+				fwrite(data, size, count, _filBuf);
+			}
 		}
 
 		unsigned char* StdioFile::GetData(int &dataSize)
 		{
+			dataSize = 0;
+
 			if (_filBuf != 0)
 			{
 				fseek(_filBuf, 0, SEEK_END);
 				dataSize = ftell(_filBuf);
 				fseek(_filBuf, 0, SEEK_SET);
 
+				if (dataSize <= 0)
+				{
+					return 0;
+				}
+
 				unsigned char* buffer = new unsigned char[dataSize];
 
 				fread(buffer, 1, dataSize, _filBuf);
@@ -106,12 +124,19 @@ namespace Andromeda
 
 		char* StdioFile::GetTextData(int &dataSize)
 		{
+			dataSize = 0;
+
 			if (_filBuf != 0)
 			{
 				fseek(_filBuf, 0, SEEK_END);
 				dataSize = ftell(_filBuf);
 				fseek(_filBuf, 0, SEEK_SET);
 
+				if (dataSize < 0)
+				{
+					return 0;
+				}
+
 				char *buffer = new char[dataSize + 1];
 				fread(buffer, dataSize, 1, _filBuf);
 
diff --git a/Andromeda/Graphics/Text/TexturedFont.cpp b/Andromeda/Graphics/Text/TexturedFont.cpp
index f0b5a1e..e7ef837 100644
--- a/Andromeda/Graphics/Text/TexturedFont.cpp
+++ b/Andromeda/Graphics/Text/TexturedFont.cpp
@@ -2,6 +2,7 @@
 #include <Andromeda/Graphics/RenderManager.h>
 #include <Andromeda/Graphics/VertexTypes.h>
 #include <Andromeda/FileSystem/FileManager.h>
+#include <Andromeda/Utils/Logger.h>
 
 #include <functional>
 
@@ -92,6 +93,8 @@ namespace Andromeda
 			_atlas = atlas;
 			_shader = 0;
 			_vertexArray = 0;
+			_font = 0;
+			_buffer = 0;
 			_fontAlign = FontCenter;
 
 			_lastLenght = 0;
@@ -105,9 +108,17 @@ namespace Andromeda
 			FileSystem::BaseFile* file = FileSystem::FileManager::Instance()->GetFile(filename);
 
 			if (file == 0)
+			{
+				Utils::Logger::Instance()->Log("TexturedFont::TexturedFont: can't open font file object %s\n", filename.c_str());
 				return;
+			}
 
-			file->Open(FileSystem::Read, FileSystem::Binary);
+			if (!file->Open(FileSystem::Read, FileSystem::Binary))
+			{
+				Utils::Logger::Instance()->Log("TexturedFont::TexturedFont: open failed %s\n", filename.c_str());
+				delete file;
+				return;
+			}
 
 			int dataSize = 0;
 			_buffer = file->GetData(dataSize);
@@ -115,9 +126,31 @@ namespace Andromeda
 			file->Close();
 			delete file;
 
+			if (_buffer == 0 || dataSize <= 0)
+			{
+				Utils::Logger::Instance()->Log("TexturedFont::TexturedFont: font data missing %s\n", filename.c_str());
+				return;
+			}
 
 			//load actual data from memory
 			LoadFromMemory(size, _buffer, dataSize);
+
+#ifdef ANDROMEDA_SWITCH
+			if (_font == 0)
+			{
+				std::string fullPath = FileSystem::FileManager::Instance()->GetMainDirPath() + filename;
+				Utils::Logger::Instance()->Log("TexturedFont::TexturedFont: fallback to file load %s\n", fullPath.c_str());
+				_font = texture_font_new_from_file(_atlas->GetAtlas(), size, fullPath.c_str());
+				if (_font == 0)
+				{
+					Utils::Logger::Instance()->Log("TexturedFont::TexturedFont: file fallback failed %s\n", fullPath.c_str());
+				}
+				else
+				{
+					Utils::Logger::Instance()->Log("TexturedFont::TexturedFont: file fallback success %s\n", fullPath.c_str());
+				}
+			}
+#endif
 		}
 
         //loading distance filed font
@@ -126,6 +159,8 @@ namespace Andromeda
             _atlas = nullptr;
             _shader = 0;
             _vertexArray = 0;
+            _font = 0;
+            _buffer = 0;
             _fontAlign = FontCenter;
 
             _lastLenght = 0;
@@ -142,7 +177,10 @@ namespace Andromeda
 		TexturedFont::~TexturedFont()
 		{
 			//delete font structure
-			texture_font_delete(_font);
+			if (_font != 0)
+			{
+				texture_font_delete(_font);
+			}
 
 			//delete font buffer
 			delete[] _buffer;
@@ -153,7 +191,23 @@ namespace Andromeda
 
 		void TexturedFont::LoadFromMemory(float size, void* memory_font, size_t memory_size)
 		{
+			if (_atlas == 0 || _atlas->GetAtlas() == 0)
+			{
+				Utils::Logger::Instance()->Log("TexturedFont::LoadFromMemory: atlas missing\n");
+				return;
+			}
+
+			if (memory_font == 0 || memory_size == 0)
+			{
+				Utils::Logger::Instance()->Log("TexturedFont::LoadFromMemory: font memory missing\n");
+				return;
+			}
+
 			_font = texture_font_new_from_memory(_atlas->GetAtlas(), size, memory_font, memory_size);
+			if (_font == 0)
+			{
+				Utils::Logger::Instance()->Log("TexturedFont::LoadFromMemory: texture_font_new_from_memory failed\n");
+			}
 
             //test
             //unsigned char* temp_bitmap = new unsigned char[1024 * 1024];
@@ -502,6 +556,12 @@ namespace Andromeda
 
 		int TexturedFont::CacheGlyphs(std::string text)
 		{
+			if (_font == 0)
+			{
+				Utils::Logger::Instance()->Log("TexturedFont::CacheGlyphs: font not initialized\n");
+				return -1;
+			}
+
 			return texture_font_load_glyphs(_font, text.c_str());
 		}
 
@@ -565,6 +625,11 @@ namespace Andromeda
 
 		float TexturedFont::GetTextLenght(std::string text)
 		{
+			if (_font == 0)
+			{
+				return 0.0f;
+			}
+
 			float lenght = 0;
 
 			const char * chartext = text.c_str();
@@ -591,6 +656,13 @@ namespace Andromeda
 
 		void TexturedFont::PrepareBuffer()
 		{
+			if (_font == 0)
+			{
+				_draw = false;
+				_textParts.clear();
+				return;
+			}
+
 			//get text lenght
 			int textLenght = 0;
 			int textHash = 0;
@@ -901,4 +973,4 @@ namespace Andromeda
             return 0;
         }        
 	}
-}
\ No newline at end of file
+}
diff --git a/Andromeda/Input/InputManager.cpp b/Andromeda/Input/InputManager.cpp
index f74307a..fdb27f2 100644
--- a/Andromeda/Input/InputManager.cpp
+++ b/Andromeda/Input/InputManager.cpp
@@ -64,7 +64,7 @@ namespace Andromeda
 
 		KeyboardDevice* InputManager::GetKeyboardDevice(int deviceNumber)
 		{
-			std::string deviceName = "keyboard" + deviceNumber;
+			std::string deviceName = "keyboard" + std::to_string(deviceNumber);
 
 			if (_devices.find(deviceName) == _devices.end())
 			{
@@ -82,7 +82,7 @@ namespace Andromeda
 
 		MouseDevice* InputManager::GetMouseDevice(int deviceNumber)
 		{
-			std::string deviceName = "mouse" + deviceNumber;
+			std::string deviceName = "mouse" + std::to_string(deviceNumber);
 
 			if (_devices.find(deviceName) == _devices.end())
 			{
@@ -100,7 +100,7 @@ namespace Andromeda
 
 		GamepadDevice* InputManager::GetGamepadDevice(int deviceNumber)
 		{
-			std::string deviceName = "gamepad" + deviceNumber;
+			std::string deviceName = "gamepad" + std::to_string(deviceNumber);
 
 			if (_devices.find(deviceName) == _devices.end())
 			{
@@ -118,7 +118,7 @@ namespace Andromeda
 
 		TouchDevice* InputManager::GetTouchDevice(int deviceNumber)
 		{
-			std::string deviceName = "touch" + deviceNumber;
+			std::string deviceName = "touch" + std::to_string(deviceNumber);
 
 			if (_devices.find(deviceName) == _devices.end())
 			{
diff --git a/Andromeda/Input/SWITCH/GamepadDeviceSwitch.cpp b/Andromeda/Input/SWITCH/GamepadDeviceSwitch.cpp
index a933b80..7f1e382 100644
--- a/Andromeda/Input/SWITCH/GamepadDeviceSwitch.cpp
+++ b/Andromeda/Input/SWITCH/GamepadDeviceSwitch.cpp
@@ -18,7 +18,7 @@ namespace Andromeda
 			_kUp = kUp;
 		}
 		
-		void GamepadDeviceSwitch::UpdateJoystick(JoystickPosition left,JoystickPosition right)
+		void GamepadDeviceSwitch::UpdateJoystick(HidAnalogStickState left,HidAnalogStickState right)
 		{
 			_leftJoy = left;
 			_rightJoy = right;
@@ -26,22 +26,22 @@ namespace Andromeda
 
 		float GamepadDeviceSwitch::LeftAnalogX()
 		{
-			return _leftJoy.dx / 32760.0f;
+			return _leftJoy.x / 32760.0f;
 		}
 		
 		float GamepadDeviceSwitch::LeftAnalogY()
 		{
-			return _leftJoy.dy / 32760.0f;
+			return _leftJoy.y / 32760.0f;
 		}
 
 		float GamepadDeviceSwitch::RightAnalogX()
 		{
-			return _rightJoy.dx / 32760.0f;
+			return _rightJoy.x / 32760.0f;
 		}
 		
 		float GamepadDeviceSwitch::RightAnalogY()
 		{
-			return _rightJoy.dy / 32760.0f;
+			return _rightJoy.y / 32760.0f;
 		}
 
 		bool GamepadDeviceSwitch::KeyDown(Gamepad::Button button)
@@ -50,40 +50,40 @@ namespace Andromeda
 			switch(button)
 			{
 			case Gamepad::Left: 
-				return (_kDown & KEY_DLEFT);
+				return (_kDown & HidNpadButton_Left);
 				break;
 			case Gamepad::Right: 
-				return (_kDown & KEY_DRIGHT);
+				return (_kDown & HidNpadButton_Right);
 				break;
 			case Gamepad::Up: 
-				return (_kDown & KEY_DUP);
+				return (_kDown & HidNpadButton_Up);
 				break;
 			case Gamepad::Down: 
-				return (_kDown & KEY_DDOWN);
+				return (_kDown & HidNpadButton_Down);
 				break;
 			case Gamepad::Triangle: 
-				return (_kDown & KEY_X);
+				return (_kDown & HidNpadButton_X);
 				break;
 			case Gamepad::Square: 
-				return (_kDown & KEY_Y);
+				return (_kDown & HidNpadButton_Y);
 				break;
 			case Gamepad::Circle: 
-				return (_kDown & KEY_A);
+				return (_kDown & HidNpadButton_A);
 				break;
 			case Gamepad::Cross: 
-				return (_kDown & KEY_B);
+				return (_kDown & HidNpadButton_B);
 				break;
 			case Gamepad::LTrigger:
-				return (_kDown & KEY_L);
+				return (_kDown & HidNpadButton_L);
 				break;
 			case Gamepad::RTrigger:
-				return (_kDown & KEY_R);
+				return (_kDown & HidNpadButton_R);
 				break;
 			case Gamepad::Select:
-				return (_kDown & KEY_MINUS);
+				return (_kDown & HidNpadButton_Minus);
 				break;
 			case Gamepad::Start:
-				return (_kDown & KEY_PLUS);
+				return (_kDown & HidNpadButton_Plus);
 				break;
 			}
 			
@@ -106,7 +106,7 @@ namespace Andromeda
 				return LeftAnalogY() < toleranceLevel * -1.0f;
 				break;
 			case Gamepad::LAnalogPushed:
-				return (_kDown & KEY_LSTICK);
+				return (_kDown & HidNpadButton_StickL);
 				break;
 			}
 
@@ -125,7 +125,7 @@ namespace Andromeda
 				return RightAnalogY() < toleranceLevel * -1.0f;
 				break;
 			case Gamepad::RAnalogPushed:
-				return (_kDown & KEY_RSTICK);
+				return (_kDown & HidNpadButton_StickR);
 				break;
 			}
 
@@ -138,40 +138,40 @@ namespace Andromeda
 			switch(button)
 			{
 			case Gamepad::Left: 
-				return !(_kUp & KEY_DLEFT);
+				return !(_kUp & HidNpadButton_Left);
 				break;
 			case Gamepad::Right: 
-				return !(_kUp & KEY_DRIGHT);
+				return !(_kUp & HidNpadButton_Right);
 				break;
 			case Gamepad::Up: 
-				return !(_kUp & KEY_DUP);
+				return !(_kUp & HidNpadButton_Up);
 				break;
 			case Gamepad::Down: 
-				return !(_kUp & KEY_DDOWN);
+				return !(_kUp & HidNpadButton_Down);
 				break;
 			case Gamepad::Triangle: 
-				return !(_kUp & KEY_X);
+				return !(_kUp & HidNpadButton_X);
 				break;
 			case Gamepad::Square: 
-				return !(_kUp & KEY_Y);
+				return !(_kUp & HidNpadButton_Y);
 				break;
 			case Gamepad::Circle: 
-				return !(_kUp & KEY_A);
+				return !(_kUp & HidNpadButton_A);
 				break;
 			case Gamepad::Cross: 
-				return !(_kUp & KEY_B);
+				return !(_kUp & HidNpadButton_B);
 				break;
 			case Gamepad::LTrigger:
-				return !(_kUp & KEY_L);
+				return !(_kUp & HidNpadButton_L);
 				break;
 			case Gamepad::RTrigger:
-				return !(_kUp & KEY_R);
+				return !(_kUp & HidNpadButton_R);
 				break;
 			case Gamepad::Select:
-				return !(_kUp & KEY_MINUS);
+				return !(_kUp & HidNpadButton_Minus);
 				break;
 			case Gamepad::Start:
-				return !(_kUp & KEY_PLUS);
+				return !(_kUp & HidNpadButton_Plus);
 				break;
 			}
 			
@@ -193,7 +193,7 @@ namespace Andromeda
 				return !(LeftAnalogY() < toleranceLevel * -1.0f);
 				break;
 			case Gamepad::LAnalogPushed:
-				return !(_kDown & KEY_LSTICK);
+				return !(_kDown & HidNpadButton_StickL);
 				break;
 			}
 
@@ -212,7 +212,7 @@ namespace Andromeda
 				return !(RightAnalogY() < toleranceLevel * -1.0f);
 				break;
 			case Gamepad::RAnalogPushed:
-				return !(_kDown & KEY_RSTICK);
+				return !(_kDown & HidNpadButton_StickR);
 				break;
 			}
 
@@ -221,4 +221,3 @@ namespace Andromeda
 
 	}
 }
-
diff --git a/Andromeda/Input/SWITCH/GamepadDeviceSwitch.h b/Andromeda/Input/SWITCH/GamepadDeviceSwitch.h
index 4c6d083..6ed53fd 100644
--- a/Andromeda/Input/SWITCH/GamepadDeviceSwitch.h
+++ b/Andromeda/Input/SWITCH/GamepadDeviceSwitch.h
@@ -22,8 +22,8 @@ namespace Andromeda
 			u64 _kDown;
 			u64 _kUp;
 			
-			JoystickPosition _leftJoy;
-			JoystickPosition _rightJoy;
+			HidAnalogStickState _leftJoy;
+			HidAnalogStickState _rightJoy;
 
 		public:
 
@@ -37,7 +37,7 @@ namespace Andromeda
 			bool KeyUp(Gamepad::Button button);
 			
 			void UpdateKesy(u64 kDown,u64 kUp);
-			void UpdateJoystick(JoystickPosition left,JoystickPosition right);
+			void UpdateJoystick(HidAnalogStickState left,HidAnalogStickState right);
 
 			friend class InputManagerSwitch;
 
diff --git a/Andromeda/Input/SWITCH/InputManagerSwitch.cpp b/Andromeda/Input/SWITCH/InputManagerSwitch.cpp
index 258fed3..f7c774d 100644
--- a/Andromeda/Input/SWITCH/InputManagerSwitch.cpp
+++ b/Andromeda/Input/SWITCH/InputManagerSwitch.cpp
@@ -10,6 +10,9 @@ namespace Andromeda
 	{
 		InputManagerSwitch::InputManagerSwitch()
 		{
+			padConfigureInput(1, HidNpadStyleSet_NpadStandard);
+			padInitializeDefault(&_pad);
+
 			_gamepad = new GamepadDeviceSwitch(); 
 		}
 		
@@ -36,18 +39,11 @@ namespace Andromeda
 
 		void InputManagerSwitch::Update()
 		{
-			//Scan all the inputs. This should be done once for each frame
-			hidScanInput();
-			
-			//update data for pad 1
-			u64 kHeld = hidKeysHeld(CONTROLLER_P1_AUTO);
-			
-			//joystick
-			JoystickPosition pos_left, pos_right;
+			padUpdate(&_pad);
+			u64 kHeld = padGetButtons(&_pad);
 
-			//Read the joysticks' position
-			hidJoystickRead(&pos_left, CONTROLLER_P1_AUTO, JOYSTICK_LEFT);
-			hidJoystickRead(&pos_right, CONTROLLER_P1_AUTO, JOYSTICK_RIGHT);
+			HidAnalogStickState pos_left = padGetStickPos(&_pad, 0);
+			HidAnalogStickState pos_right = padGetStickPos(&_pad, 1);
 			
 			//update Ggamepad device
 			_gamepad->UpdateKesy(kHeld,kHeld);
diff --git a/Andromeda/Input/SWITCH/InputManagerSwitch.h b/Andromeda/Input/SWITCH/InputManagerSwitch.h
index 788a465..5c57535 100644
--- a/Andromeda/Input/SWITCH/InputManagerSwitch.h
+++ b/Andromeda/Input/SWITCH/InputManagerSwitch.h
@@ -13,6 +13,7 @@ namespace Andromeda
 			private:
 			
 				GamepadDeviceSwitch* _gamepad;
+				PadState _pad;
 			
 			public:
 			
diff --git a/Andromeda/Input/SWITCH/TouchDeviceSwitch.cpp b/Andromeda/Input/SWITCH/TouchDeviceSwitch.cpp
index 2198460..70ef79a 100644
--- a/Andromeda/Input/SWITCH/TouchDeviceSwitch.cpp
+++ b/Andromeda/Input/SWITCH/TouchDeviceSwitch.cpp
@@ -13,29 +13,45 @@ namespace Andromeda
 
 		int TouchDeviceSwitch::GetTouchCount()
 		{
-			return hidTouchCount();
+			HidTouchScreenState touchState;
+			if (hidGetTouchScreenStates(&touchState, 1) == 0)
+			{
+				return 0;
+			}
+
+			return touchState.count;
 		}
 
 		int TouchDeviceSwitch::GetTouchX(int touchNumber)
 		{
-			touchPosition touch;
-			
-			//Read the touch screen coordinates
-            hidTouchRead(&touch, touchNumber);
-			
-			
-			return touch.px;
+			HidTouchScreenState touchState;
+			if (hidGetTouchScreenStates(&touchState, 1) == 0)
+			{
+				return 0;
+			}
+
+			if (touchNumber < 0 || touchNumber >= touchState.count)
+			{
+				return 0;
+			}
+
+			return touchState.touches[touchNumber].x;
 		}
 
 		int TouchDeviceSwitch::GetTouchY(int touchNumber)
 		{
-			touchPosition touch;
-			
-			//Read the touch screen coordinates
-            hidTouchRead(&touch, touchNumber);
-			
-			
-			return touch.py;
+			HidTouchScreenState touchState;
+			if (hidGetTouchScreenStates(&touchState, 1) == 0)
+			{
+				return 0;
+			}
+
+			if (touchNumber < 0 || touchNumber >= touchState.count)
+			{
+				return 0;
+			}
+
+			return touchState.touches[touchNumber].y;
 		}
 
 	}
diff --git a/Andromeda/System/SWITCH/GameLoaderSwitch.cpp b/Andromeda/System/SWITCH/GameLoaderSwitch.cpp
index d2face8..53d3ee1 100644
--- a/Andromeda/System/SWITCH/GameLoaderSwitch.cpp
+++ b/Andromeda/System/SWITCH/GameLoaderSwitch.cpp
@@ -1,9 +1,20 @@
 #include <Andromeda/System/SWITCH/GameLoaderSwitch.h>
 #include <Andromeda/Graphics/GL/RenderManagerGL3.h>
+#include <Andromeda/FileSystem/FileManager.h>
 #include <Andromeda/Input/InputManager.h>
 #include <Andromeda/Utils/Logger.h>
 
 #include <iostream>
+#include <sys/stat.h>
+
+namespace
+{
+	bool FileExists(const char* path)
+	{
+		struct stat st;
+		return stat(path, &st) == 0;
+	}
+}
 
 namespace Andromeda
 {
@@ -16,21 +27,47 @@ namespace Andromeda
 
 		void GameLoaderSwitch::Run()
 		{
+			Result romfsResult = romfsInit();
+
+			mkdir("sdmc:/switch", 0777);
+			mkdir("sdmc:/switch/JellyCar", 0777);
+
+			std::string mainDir = "";
+			if (R_SUCCEEDED(romfsResult) && FileExists("romfs:/Assets/Jelly/scene_list.xml"))
+			{
+				mainDir = "romfs:/";
+			}
+			else if (FileExists("sdmc:/switch/JellyCar/Assets/Jelly/scene_list.xml"))
+			{
+				mainDir = "sdmc:/switch/JellyCar/";
+			}
+
+			FileSystem::FileManager::Instance()->SetMainDirPath(mainDir);
+			FileSystem::FileManager::Instance()->SetSaveDirPath("sdmc:/switch/JellyCar/");
+
 			Utils::Logger::Instance()->Log("Start\n");
-			
+			Utils::Logger::Instance()->Log("PatchedBuild: switch-exit-fontfix-shaderfix-2026-02-27\n");
+			Utils::Logger::Instance()->Log("romfsInit: 0x%x\n", romfsResult);
+			Utils::Logger::Instance()->Log("MainDir: %s\n", mainDir.c_str());
+
 			//get render manager
 			_renderManager = Graphics::RenderManager::Instance();
-			
-			if(!((Graphics::RenderManagerGL3*)_renderManager)->InitEgl(nwindowGetDefault()))
+
+			if (!((Graphics::RenderManagerGL3*)_renderManager)->InitEgl(nwindowGetDefault()))
 			{
 				Utils::Logger::Instance()->Log("Failed to create gl window\n");
+
+				if (R_SUCCEEDED(romfsResult))
+				{
+					romfsExit();
+				}
 				return;
 			}
-			
-			//set configuration 
+
+			//set configuration
 			Utils::Logger::Instance()->Log("Config\n");
 			_gameManager->Configure();
-			
+
 			Utils::Logger::Instance()->Log("Set window size\n");
 
 			//get default monitor
@@ -39,27 +76,26 @@ namespace Andromeda
 			//set input manager
 			Input::InputManager* intputManager = Input::InputManager::Instance();
 
+			Utils::Logger::Instance()->Log("Init Render\n");
 
-			Utils::Logger::Instance()->Log("Init Render\n");			
-
-			//create renderer			
+			//create renderer
 			_renderManager->Init();
-			
-			
+
 			Utils::Logger::Instance()->Log("Init Game Manager\n");
 
-			//init game manager 
+			//init game manager
 			_gameManager->Init();
-			
+
 			Utils::Logger::Instance()->Log("Start loop\n");
 
+			bool appletRunning = true;
+
 			//main loop
-			while (_gameManager->Running() && appletMainLoop())
+			while (_gameManager->Running() && (appletRunning = appletMainLoop()))
 			{
 				//update input manager
 				intputManager->Update();
 
-
 				//game stuff
 				_gameManager->HandleEvents();
 				_gameManager->Update();
@@ -69,18 +105,22 @@ namespace Andromeda
 				_renderManager->SwapBuffers();
 			}
 
-			//clean game manager
+			Utils::Logger::Instance()->Log("Loop end: running=%d applet=%d\n", _gameManager->Running(), appletRunning);
+
+			// Proper teardown order for current libnx/OpenGL homebrew behavior.
+			Utils::Logger::Instance()->Log("Switch cleanup: game manager\n");
 			_gameManager->CleanUp();
+			Utils::Logger::Instance()->Log("Switch cleanup: game manager done\n");
 
-			//finish render manager;
+			Utils::Logger::Instance()->Log("Switch cleanup: render finish\n");
 			_renderManager->Finish();
-
-			//remove render manager
-			delete _renderManager;
+			Utils::Logger::Instance()->Log("Switch cleanup: render finish done\n");
 
 			//log exit
 			Utils::Logger::Instance()->Log("Exit\n");
+			Utils::Logger::Instance()->Log("Switch return to libnx exit\n");
+			return;
 		}
 
 	}
-}
\ No newline at end of file
+}
diff --git a/Andromeda/Utils/Logger.cpp b/Andromeda/Utils/Logger.cpp
index 576339b..1ef1609 100644
--- a/Andromeda/Utils/Logger.cpp
+++ b/Andromeda/Utils/Logger.cpp
@@ -75,10 +75,13 @@ namespace Andromeda
 				if (file == 0)
 					return;
 
-				file->Open(FileSystem::Append, FileSystem::Text);
-				file->Write(cbuffer, sizeof(char), strlen(cbuffer));
-				file->Close();
+				if (!file->Open(FileSystem::Append, FileSystem::Text))
+				{
+					delete file;
+					return;
+				}
 
+				file->Write(cbuffer, sizeof(char), strlen(cbuffer));
 				delete file;
 			}
 		}
@@ -109,10 +112,13 @@ namespace Andromeda
 				if (file == 0)
 					return;
 
-				file->Open(FileSystem::Append, FileSystem::Text);
-				file->Write((void*)logMessage.c_str(), sizeof(char), logMessage.length());
-				file->Close();
+				if (!file->Open(FileSystem::Append, FileSystem::Text))
+				{
+					delete file;
+					return;
+				}
 
+				file->Write((void*)logMessage.c_str(), sizeof(char), logMessage.length());
 				delete file;
 			}
 		}
@@ -143,10 +149,13 @@ namespace Andromeda
 				if (file == 0)
 					return;
 
-				file->Open(FileSystem::Append, FileSystem::Text);
-				file->Write((void*)logMessage.c_str(), sizeof(char), logMessage.length());
-				file->Close();
+				if (!file->Open(FileSystem::Append, FileSystem::Text))
+				{
+					delete file;
+					return;
+				}
 
+				file->Write((void*)logMessage.c_str(), sizeof(char), logMessage.length());
 				delete file;
 			}
 		}
diff --git a/Libs/freetype_gl/texture-font.c b/Libs/freetype_gl/texture-font.c
index bff7957..c04ff96 100644
--- a/Libs/freetype_gl/texture-font.c
+++ b/Libs/freetype_gl/texture-font.c
@@ -71,15 +71,29 @@ texture_font_load_face(texture_font_t *self, float size,
     /* Select charmap */
     error = FT_Select_Charmap(*face, FT_ENCODING_UNICODE);
     if(error) {
-        fprintf(stderr, "FT_Error (line %d, code 0x%02x) : %s\n",
-                __LINE__, FT_Errors[error].code, FT_Errors[error].message);
-        FT_Done_Face(*face);
-        FT_Done_FreeType(*library);
-        return 0;
+        if ((*face)->num_charmaps > 0) {
+            error = FT_Set_Charmap(*face, (*face)->charmaps[0]);
+        }
+
+        if(error) {
+            fprintf(stderr, "FT_Error (line %d, code 0x%02x) : %s\n",
+                    __LINE__, FT_Errors[error].code, FT_Errors[error].message);
+            FT_Done_Face(*face);
+            FT_Done_FreeType(*library);
+            return 0;
+        }
     }
 
     /* Set char size */
     error = FT_Set_Char_Size(*face, (int)(size * HRES), 0, DPI * HRES, DPI);
+    if(error) {
+        float logical_size = size > 256.f ? (size / 100.f) : size;
+        if (logical_size < 1.f) {
+            logical_size = 1.f;
+        }
+
+        error = FT_Set_Pixel_Sizes(*face, 0, (FT_UInt)logical_size);
+    }
 
     if(error) {
         fprintf(stderr, "FT_Error (line %d, code 0x%02x) : %s\n",
@@ -231,7 +245,7 @@ texture_font_init(texture_font_t *self)
     self->lcd_weights[3] = 0x40;
     self->lcd_weights[4] = 0x10;
 
-    if (!texture_font_load_face(self, self->size * 100.f, &library, &face))
+    if (!texture_font_load_face(self, self->size, &library, &face))
         return -1;
 
     self->underline_position = face->underline_position / (float)(HRESf*HRESf) * self->size;
@@ -249,9 +263,9 @@ texture_font_init(texture_font_t *self)
     }
 
     metrics = face->size->metrics;
-    self->ascender = (metrics.ascender >> 6) / 100.0;
-    self->descender = (metrics.descender >> 6) / 100.0;
-    self->height = (metrics.height >> 6) / 100.0;
+    self->ascender = (metrics.ascender >> 6);
+    self->descender = (metrics.descender >> 6);
+    self->height = (metrics.height >> 6);
     self->linegap = self->height - self->ascender + self->descender;
     FT_Done_Face( face );
     FT_Done_FreeType( library );
